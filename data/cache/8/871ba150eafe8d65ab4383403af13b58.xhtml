
<h1 class="sectionedit1" id="egov_maerkmed">eGov märkmed</h1>
<div class="level1">

<p>
Alates 21.03.2016 
</p>

<p>
<strong>Skype grupid</strong>
</p>
<ul>
<li class="level1"><div class="li"> TETRIS QA</div>
</li>
<li class="level1"><div class="li"> QA</div>
</li>
<li class="level1"><div class="li"> Töötukassa</div>
</li>
<li class="level1"><div class="li"> Töötukassa live </div>
</li>
</ul>

<p>
<strong>Üldised spekid</strong>
</p>
<ul>
<li class="level1"><div class="li"> <a href="https://confluence.nortal.com/display/PUBLICBU/Ajaaruandlus" class="urlextern" title="https://confluence.nortal.com/display/PUBLICBU/Ajaaruandlus" rel="nofollow">Ajaaruandlus</a></div>
</li>
<li class="level1"><div class="li"> <a href="https://confluence.nortal.com/display/EMPIS/X-tee+testandmed" class="urlextern" title="https://confluence.nortal.com/display/EMPIS/X-tee+testandmed" rel="nofollow">X-tee testandmed</a></div>
</li>
<li class="level1"><div class="li"> <a href="https://confluence.nortal.com/display/TVHTVT/Registrite+testandmed" class="urlextern" title="https://confluence.nortal.com/display/TVHTVT/Registrite+testandmed" rel="nofollow">Registrite testandmed</a></div>
</li>
<li class="level1"><div class="li"> <a href="https://confluence.nortal.com/display/TVHTVT/Keskkonnad" class="urlextern" title="https://confluence.nortal.com/display/TVHTVT/Keskkonnad" rel="nofollow">Keskkonnad</a></div>
</li>
<li class="level1"><div class="li"> <a href="https://confluence.nortal.com/pages/viewpage.action?pageId=130128116" class="urlextern" title="https://confluence.nortal.com/pages/viewpage.action?pageId=130128116" rel="nofollow">Analüütikutele issue lisamise eripärad</a></div>
</li>
<li class="level1 node"><div class="li"> <a href="https://confluence.nortal.com/display/TVHTVT/TETRIS+Home" class="urlextern" title="https://confluence.nortal.com/display/TVHTVT/TETRIS+Home" rel="nofollow">Tetris home</a></div>
<ul>
<li class="level2"><div class="li"> <a href="https://confluence.nortal.com/pages/viewpage.action?pageId=143819710" class="urlextern" title="https://confluence.nortal.com/pages/viewpage.action?pageId=143819710" rel="nofollow">Vaided üldine</a></div>
</li>
</ul>
</li>
</ul>

<p>
<strong>Üldised taskid</strong>
</p>
<ul>
<li class="level1"><div class="li"> <a href="https://jira.nortal.com/browse/EGOVERNMENTEE-1" class="urlextern" title="https://jira.nortal.com/browse/EGOVERNMENTEE-1" rel="nofollow">EGOVERNMENTEE-1</a> - eGov üldkoosoleku aja logimise task </div>
</li>
<li class="level1"><div class="li"> <a href="https://jira.nortal.com/browse/TETRIS-2" class="urlextern" title="https://jira.nortal.com/browse/TETRIS-2" rel="nofollow">TETRIS-2</a> - Igapäevase SCRUM-i aja logimise task </div>
</li>
<li class="level1"><div class="li"> <a href="https://jira.nortal.com/browse/TETRIS-4" class="urlextern" title="https://jira.nortal.com/browse/TETRIS-4" rel="nofollow">TETRIS-4</a> - Koosolekute aja logimise task </div>
</li>
<li class="level1"><div class="li"> <a href="https://jira.nortal.com/browse/COM-8" class="urlextern" title="https://jira.nortal.com/browse/COM-8" rel="nofollow">COM-8</a> - tehniliste probleemide kõrvaldamise task (nt IP aadressi tõrge laptopil)</div>
</li>
<li class="level1"><div class="li"> <a href="https://jira.nortal.com/browse/TETRIS-1370" class="urlextern" title="https://jira.nortal.com/browse/TETRIS-1370" rel="nofollow">TETRIS-1370</a> - Tetrise support task </div>
</li>
<li class="level1"><div class="li"> <a href="https://jira.nortal.com/browse/TETRIS-1626TETRIS-1626" class="urlextern" title="https://jira.nortal.com/browse/TETRIS-1626TETRIS-1626" rel="nofollow">https://jira.nortal.com/browse/TETRIS-1626TETRIS-1626</a> - Kalle sisseelamise task </div>
</li>
<li class="level1 node"><div class="li"> <a href="https://jira.nortal.com/browse/TETRIS-1602" class="urlextern" title="https://jira.nortal.com/browse/TETRIS-1602" rel="nofollow">TETRIS-1602</a> - arendajate korrapidamise üldine task - (nb! nädalate kaupa on eraldi subtaskid)</div>
<ul>
<li class="level2"><div class="li"> korrapidaja arendaja ülesanded <a href="https://confluence.nortal.com/pages/viewpage.action?pageId=137993729" class="urlextern" title="https://confluence.nortal.com/pages/viewpage.action?pageId=137993729" rel="nofollow">confus</a></div>
</li>
<li class="level2"><div class="li"> TETRIS ja REDIS korrapidamine <a href="https://docs.google.com/spreadsheets/d/1VmZP-UBqsIaVRSmPi_ktXjPW_tgFX7U1qDopufdnygk/edit#gid=0" class="urlextern" title="https://docs.google.com/spreadsheets/d/1VmZP-UBqsIaVRSmPi_ktXjPW_tgFX7U1qDopufdnygk/edit#gid=0" rel="nofollow">GoogleDocs-i tabel</a></div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> <a href="https://jira.nortal.com/browse/EMPIS-199064" class="urlextern" title="https://jira.nortal.com/browse/EMPIS-199064" rel="nofollow">EMPIS-199064</a> - Voore ürituse ajalogimine (mittebillitav)</div>
</li>
</ul>

</div>
<!-- EDIT1 SECTION "eGov märkmed" [1-1938] -->
<h2 class="sectionedit2" id="kasutatud_akronueuemid">Kasutatud akronüümid</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> TVH - TööVõimeHindamine</div>
</li>
<li class="level1"><div class="li"> TVT - TööVõimeTaotlus</div>
</li>
<li class="level1"><div class="li"> MVM - MakseViisiMuutmine</div>
</li>
<li class="level1"><div class="li"> TKO - TöötuKassaOsakond</div>
</li>
<li class="level1"><div class="li"> TSK - TerviseSeisundiKirjeldus</div>
</li>
<li class="level1"><div class="li"> TÖR - TÖötamiseRegister</div>
</li>
<li class="level1"><div class="li"> ITP - IseTeenindusPortaal</div>
</li>
<li class="level1"><div class="li"> CAS - CentralAuthenticationService</div>
</li>
<li class="level1"><div class="li"> TST - ToetuseSaamiseTingimused</div>
</li>
<li class="level1"><div class="li"> TTO - TervishoiuTeenuseOsutaja</div>
</li>
<li class="level1"><div class="li"> TVR - TööVõimeReform</div>
</li>
<li class="level1"><div class="li"> NK - NõueteKohane</div>
</li>
</ul>

</div>
<!-- EDIT2 SECTION "Kasutatud akronüümid" [1939-2355] -->
<h2 class="sectionedit3" id="tetris_truekistega_seotud_probleemid">Tetris trükistega seotud probleemid</h2>
<div class="level2">

<p>
Empises on <strong>Administreerimine</strong> →  <strong>Dokumentide Haldus</strong> → <strong>Trükiste Haldus</strong>. Tab-il TETRIS on tetrise trükised. seal tuleb õige trükis otsida üles ja vaadata kas saab muuta seda. kui saab, siis saab klient seda ise ka lives teha
</p>

<p>
Juhul kui on vajadus siiski baasi kaudu muudatusi teha, siis otsuse põhjused asuvad näiteks siin: 
</p>
<pre class="code">select * 
     from TVR_OTSUS_POHJUS top
     where kuni_kp is null
     and top.otsus_protsess_kood = &#039;TVT&#039;
     and top.otsus_tyyp_kood = &#039;MITTEMAARAMINE&#039;
     and top.otsus_pohjus_kood = &#039;ISIK_ON_TOOVOIMELINE&#039;;</pre>

</div>
<!-- EDIT3 SECTION "Tetris trükistega seotud probleemid" [2356-2976] -->
<h2 class="sectionedit4" id="varia">Varia</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> TETRISES kasutatavad REST-teenused (<a href="https://tk-cas.webmedia.int/swagger/" class="urlextern" title="https://tk-cas.webmedia.int/swagger/" rel="nofollow">https://tk-cas.webmedia.int/swagger/</a>) </div>
</li>
<li class="level1"><div class="li"> Issue lisamisel silmas pidada (<a href="https://confluence.nortal.com/pages/viewpage.action?pageId=130128116" class="urlextern" title="https://confluence.nortal.com/pages/viewpage.action?pageId=130128116" rel="nofollow">https://confluence.nortal.com/pages/viewpage.action?pageId=130128116</a>)</div>
</li>
</ul>

<p>
ajutine sisselogimine hetkel arli/Parool123
</p>

<p>
central authentication service kohta <a href="https://en.wikipedia.org/wiki/Central_Authentication_Service" class="urlextern" title="https://en.wikipedia.org/wiki/Central_Authentication_Service" rel="nofollow">wiki</a>
</p>

</div>
<!-- EDIT4 SECTION "Varia" [2977-3333] -->
<h2 class="sectionedit5" id="skriptid_ja_seosed">Skriptid ja seosed</h2>
<div class="level2">

<p>
<strong>Taotluse ja rakenduse kasutaja omavaheline seos</strong>
</p>
<pre class="code">TETRIS_TEST.TAOTLUS.ID
TETRIS_TEST.TAOTLUS_MENETLEJA_AJALUGU.KASUTAJAKONTO_ID
EMPIS_LATEST.OS_KASUTAJAKONTO
EMPIS_LATEST.OS_KASUTAJA</pre>

<p>
<strong>Taotluse ja makseviisi seosed TETRIS_TEST-is</strong>
</p>
<pre class="code">select m.makseviis_kood, k.kojukanne_kood
       from taotlus t 
       left join tvt_taotlus tt on t.id = tt.taotlus_id
       left join mvm_taotlus mt on tt.taotlus_id = mt.tvt_taotlus_id
       left join makseviis m on mt.makseviis_id = m.id
       left join pangakonto p on m.id = p.makseviis_id
       left join kojukanne k on m.id = k.makseviis_id
       left join kojukanne_aadress ka on k.id = ka.kojukanne_id
       where t.id = 1011008   </pre>

<p>
<strong>Taotluse kontrollid ja tulemused</strong>
</p>
<pre class="code">select ktl.* 
       from taotlus t 
       join kontroll k on t.id = k.taotlus_id
       join kontroll_tulemus kt on k.id = kt.kontroll_id
       join kontroll_tulemus_lisaandmed ktl on kt.id = ktl.kontroll_tulemus_id
       where t.id = 1010972
       and k.liik_kood = &#039;KASVATAB_LAST&#039;
       and (ktl.tyyp_kood = &#039;RR_HOOLDUS_TYYP&#039; or ktl.tyyp_kood = &#039;RR_HOOLDUS_STAATUS&#039;);</pre>

<p>
<strong>Konkreetse privileegi ja seda omavate kasutajate seos</strong>
</p>
<pre class="code">	-- tetrise schemast id-d
	select * from sec_roll_privileeg where privileeg_kood = &#039;tvh.menetleja.roll&#039;</pre>
<pre class="code">	-- empise schemast kasutajad
select kasutaja.*
     from os_roll r
     join os_kasutajakonto_roll kr on kr.roll_id = r.id 
     join os_kasutajakonto k on kr.kasutajakonto_id = k.id
     join os_kasutaja kasutaja on k.kasutaja_id = kasutaja.id 
     where (r.kehtiv_kuni &gt; sysdate or r.kehtiv_kuni is null)
     and (kr.kehtiv_kuni &gt; sysdate or kr.kehtiv_kuni is null)
     and (k.kehtiv_kuni &gt; sysdate or k.kehtiv_kuni is null)
     and (kasutaja.kehtiv_kuni &gt; sysdate or kasutaja.kehtiv_kuni is null)
     and r.id in (
     1000000741,
     1000000738,
     1000000740,
     1000000758,
     1000000739,
     1000000640
     )</pre>

<p>
<strong>Integratsiooniteenuse päringud kirjutatakse järgmisesse tabelisse: </strong>
</p>
<pre class="code">select *
       from INT_SERVICE_REQUEST</pre>

<p>
<strong>Baasist konkreetse muudatuse teinud taski leidmine</strong>
TÄIENDADA SEOST!!! 
</p>
<pre class="code">select * from sys_db_change_history
select * from sys_db_change_history_log where sql_text like &#039;%SAAB_PAASTETOETUS%&#039;;</pre>

<p>
<strong> EMPIS keskkonna uuendamine </strong>
</p>
<ol>
<li class="level1"><div class="li"> vali bamboost keskkond mida soovid uuendada (nt “update latest”)</div>
</li>
<li class="level1"><div class="li"> vali nimekirjast build mida soovid paigaldada, klikka rohelisel lingil</div>
</li>
<li class="level1"><div class="li"> vali kuval “deploy” taga “play” nuppu ja järgmises aknas ok.</div>
</li>
</ol>

<p>
<strong> Millele viitab sys_muutuja_id </strong>
</p>
<ul>
<li class="level1"><div class="li"> juhul kui tegemist on REDIS kasutajaga, siis REDIS_ISIK_ROLL.ID</div>
</li>
<li class="level1"><div class="li"> juhul kui tegemist on TETRIS kasutajaga, siis EMPIS_TO_TETRIS.EMPIS_KASUTAJAKONTO.ID (vist?)</div>
</li>
</ul>

</div>
<!-- EDIT5 SECTION "Skriptid ja seosed" [3334-] -->